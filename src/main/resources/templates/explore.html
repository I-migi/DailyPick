<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì˜í™” íƒìƒ‰ | DailyPick</title>
    <link rel="stylesheet" href="/css/explore.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<header class="explore-header">
    <h1>ğŸ” ì˜í™” íƒìƒ‰</h1>
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="ì˜í™” ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”...">
        <button id="searchBtn">ê²€ìƒ‰</button>
    </div>
    <div class="filter-bar">
        <button class="filter-btn">ì „ì²´</button>
        <button class="filter-btn">ì•¡ì…˜</button>
        <button class="filter-btn">ë¡œë§¨ìŠ¤</button>
        <button class="filter-btn">ì½”ë¯¸ë””</button>
        <button class="filter-btn">SF</button>
        <button class="filter-btn">ìŠ¤ë¦´ëŸ¬</button>
    </div>
</header>

<main class="explore-main">
    <div class="grid" id="movieGrid">
    </div>
    <p class="empty-message" id="emptyMessage" style="display: none;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
</main>

<footer class="footer">
    &copy; 2025 DailyPick | All rights reserved
</footer>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const grid = document.getElementById("movieGrid");
        const emptyMessage = document.getElementById("emptyMessage");
        const searchInput = document.getElementById("searchInput");
        const searchBtn = document.getElementById("searchBtn");

        // ì˜í™” ì¹´ë“œ ê·¸ë¦¬ê¸° í•¨ìˆ˜
        function renderMovies(movies) {
            grid.innerHTML = "";
            if (!movies || movies.length === 0) {
                emptyMessage.style.display = "block";
                return;
            }
            emptyMessage.style.display = "none";
            movies.forEach(movie => {
                const card = document.createElement("div");
                card.className = "movie-card";
                card.innerHTML = `
    <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}">
    <div class="info">
        <h3>${movie.title}</h3>
        <p>${movie.release_date || 'ì •ë³´ ì—†ìŒ'}</p>
    </div>
`;

                card.addEventListener("click", () => {
                    location.href = `/movie?movieId=${movie.id}`;
                });
                grid.appendChild(card);
            });
        }

        // ìµœê·¼ ì˜í™” ë¡œë“œ
        function loadRecentlyMovies() {
            fetch('/api/movies/recently')
                .then(res => res.json())
                .then(data => renderMovies(data))
                .catch(err => {
                    console.error('ì˜í™” ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', err);
                    emptyMessage.style.display = "block";
                });
        }

        // ê²€ìƒ‰
        function searchMovies(keyword) {
            fetch(`/api/movies/search?keyword=${encodeURIComponent(keyword)}`)
                .then(res => res.json())
                .then(data => renderMovies(data))
                .catch(err => {
                    console.error('ê²€ìƒ‰ ì‹¤íŒ¨:', err);
                    emptyMessage.style.display = "block";
                });
        }

        // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        searchBtn.addEventListener("click", () => {
            const keyword = searchInput.value.trim();
            if (keyword) {
                searchMovies(keyword);
            } else {
                loadRecentlyMovies();
            }
        });

        // ì´ˆê¸° ë¡œë”©
        loadRecentlyMovies();
    });
</script>


</body>
</html>
